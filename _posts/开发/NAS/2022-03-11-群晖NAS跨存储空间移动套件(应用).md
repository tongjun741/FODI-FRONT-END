---
tags:
    - NAS
---

一、前言
之前一篇文章《群晖NAS跨存储空间移动共享文件夹(NAS新增磁盘)》我们介绍了如何在NAS槽位新增磁盘，并构建新的磁盘阵列，最后再将部分共享文件夹移动到新的磁盘空间即可。弄完这一系列操作之后，考虑到原来的存储空间太小，于是打算将所有的套件（应用）安装目录由原来的存储空间移动到新的磁盘空间来。于是几经折腾，终于将所有的应用都移动到了新的存储空间来。

下面就是我记录的整个过程，以及其中的一些注意事项。

ps：本文只讲解了如何跨存储空间移动套件，如果需要移动共享文件夹请参考《群晖NAS跨存储空间移动共享文件夹(NAS新增磁盘)》。

二、移动套件（应用）
1、移动方案介绍
如果尝试过移动套件的小伙伴会发现，我们在套件中心只能够看到套件当前的安装地址，并不能够像共享文件夹一样对套件的存储地址进行更换。因此我们需要自己想办法移动。总的来说有两个方式可以移动套件。一是通过后台直接移动；另外一种是借助工具实现移动。

A、直接后台移动
这种方式是通过shell直接登录后台找到套件安装地址，然后移动到目标存储空间即可。大致路径为：/volumeX/@appstore（其中X为自己的存储空间序号）。由于这种方式比较复杂，且有一定的难度和风险（不要问我为什么有知道有风险，血泪史啊，不解释），所以我们并不推荐。



B、通过工具移动
大家稍微搜索下都会发现网上有大牛提供了一个移动工具mods package manager。使用工具可以实现比较简单的移动。但是这个工具的移动也会有些坑，后面我们会具体讲解。

2、mods package manager安装
A、下载安装
mods package manager的安装比较简单。因为其实一个spk包，所以下载下来之后直接在套件中心通过手工安装的方式安装即可。但是这个工具的现在比较麻烦点，因为其实放到github的，下载地址在外网所以你懂的。但是我们也可以解决这个问题。首先我们需要绑定本机的Host> 151.101.108.133 raw.githubusercontent.com。然后访问github地址：https://github.com/owen0o0/PackageManager，接着点击PackageManager.spk。



然后再目标页面点击下载即可。



如果大家嫌麻烦，我这里为大家下载下来了。大家关注文末的公众号直接回复"移动工具"即可获取文件。

B、工具配置（MODS Package Manager白屏处理）
下载完成之后就是安装了。安装过程就不详细介绍了。就是普通的手动安装流程。安装完成之后大家大家打开之后都会发现页面无法展示（展示空白）。



展示白屏的原因是因为该工具使用了jquery实现，但是其代码中引用的是google提供的jquery.mini.js，由于你懂的原因该地址无法访问。于是我们需要将其修改为国内的地址。首先我们通过shell登陆后台，然后找到文件/volumeX/@appstore/MODS_PackageManager/ui/mvpkg.php。



通过vi的方式进行修改，将其中的https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js修改为http://libs.baidu.com/jquery/2.0.0/jquery.min.js即可。



完成修改之后，我们再重新打开该套件就可以了。



3、移动套件
执行具体的移动操作前请先看第三节注意事项！

使用软件就比较简单了，直接选择要移动套件，然后选择目标存储空间，选择移动即可。

移动完成之后有些套件可能会出现异常，在套件中心会显示需要修复，此时直接点击修复即可。



三、注意事项
我几乎把所有的套件都从volume1移动到了volume2中。在整个移动过程中有一个套件移动会导致数据丢失，那就是Docker。Docker在移动修复后，所有的容器和镜像都丢失了，所以建议移动docker之间将所有的容器或者导出备份。具体方式如下图，可以选择只备份配置，也可以选择配置和整个容器都备份。移动完成之后再导入即可。如果导出的是配置，则需要Docker移动之后需要重新安装容器，然后再导入配置。如果导出的是容器内容和设置，貌似就不需要重新安装容器了，直接导入即可。


————————————————
版权声明：本文为CSDN博主「程序员Daddy」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/hilaryfrank/article/details/109750951